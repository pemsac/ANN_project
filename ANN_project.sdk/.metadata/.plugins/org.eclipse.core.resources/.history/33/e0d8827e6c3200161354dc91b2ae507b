/**
 *
 * Carlos III University of Madrid.
 *
 * Master Final Thesis: Heartbeat classifier based on ANN (Artificial Neural
 * Network).
 *
 * Author: Pedro Marcos Solórzano
 * Tutor: Luis Mengibar Pozo (Tutor)
 *
 *
 * Feed-forward Artificial Neuronal Network.
 * Header file with the class definition.
 *
 *
 */

/*
 * Header guard
 */
#ifndef ANN_H_
#define ANN_H_

/*
 * Include math functions.
 */
#include <math.h>

/*
 * Feed-forward Artificial Neuronal Network class
 */
class ANN{

private:
  /*
   * Protected variables:
   * weight & output value of each neuron
   * number of layers & of neurons in each one.
   */
  double ***_weights, **_outputs;
  int _numLayer, *_layerSizes;

public:
  /*
   * Empty constructor
   */
  ANN();
  /*
   * Constructor method. Create a new ANN setting:
   * - number of layers (including input & output layers)
   * - number of neurons in each layer
   * - weights of each neuron connection.
   */
  ANN(int layers, int *layerSizes, double ***weights);
  /*
   * Destructor
   */
  virtual ~ANN();
  /*
   * Process a new input and return the result (last layer outputs)
   */
  double* feedforward(double *input);
  /*
   * Getters & setters
   */
  int getLayer();
  int getLayerSizes(int i);
};

#endif
