/**
 *
 * Carlos III University of Madrid.
 *
 * Master Final Thesis: Heartbeat classifier based on ANN (Artificial Neural
 * Network).
 *
 * Author: Pedro Marcos Solórzano
 * Tutor: Luis Mengibar Pozo (Tutor)
 *
 *
 * Back-propagation training for feedforward ANN
 * Header file
 *
 *
 */

/*
 * Header guard
 */
#ifndef TRAINING_H_
#define TRAINING_H_

/*
 * Includes
 */
#include "ANN.h"

/*
 * Back-propagation training class
 * This class is derived from ANN class
 */
class Training{

private:
  /*
   * Private variables:
   * Besides the protected ANN variables, the training needs some parameters
   * such as delta error, learning Rate and momentum.
   * On the other hand, an extra variable to store the previous weight of the
   * neurons is needed.
   */
  double **_deltaErr, ***_prevWeight, _learnRate, _momentum;

  ANN *_ann;

public:
  /*
   * Empty constructor
   */
  Training();
  /*
   * Constructor method. It creates a new ANN and trains it. These parameters
   * must be set:
   * - number of layers (including input & output layers)
   * - number of neurons in each layer
   * - momentum for the training
   * - learning rate
   * - delta errors for each neuron.
   */
  Training(int numLayer, int *layerSize, double momentum, double learnRate,
            double **deltaErr);
  /*
   * Training method. It trains the ANN
   */
  double backpropagation(double **trainMat, int numInputs, int maxInter,
                         int minSquareErr);
  /*
   * Destructor
   */
  virtual ~Training();
};

#endif
